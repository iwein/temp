<div class="component-candidate-profile {{ editClass }}" ng-show="ready" ng-class="{
  'form-open': isFormOpen,
  editing: isEditing,
}">

  <div class="status">
    <button id="button-edit-profile" class="fl-rg btn-edit" ng-click="profile.edit()">
      <i class="fa fa-pencil"></i>
      <translate>Edit mode</translate>
    </button>
    <button id="button-finish-edit" class="fl-rg btn-edit" ng-click="profile.stopEdit()">
      <i class="fa fa-check"></i>
      <translate>Finish editing</translate>
    </button>
    <div class="clearfix"></div>
  </div>

  <div class="profile-workflow hidden" ng-if="!isEditing && completionStage">
    <div class="panel panel-default">
      <div class="panel-body">
        <form ng-show="completionStage === 'summary'" ng-submit="sendCompletion(completion)">
          <div class="form-group required">
            <label translate>Summary</label>
            <textarea class="form-control" required ng-model="completion.summary">
            </textarea>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary" translate>Submit</button>
          </div>
        </form>

        <form ng-show="completionStage === 'availability'" ng-submit="sendCompletion(completion)">
          <div class="form-group required">
            <label translate>Availability</label>
            <textarea class="form-control" required ng-model="completion.availability">
            </textarea>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary" translate>Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="row" ng-if="candidate">
    <div class="col-sm-3 sidebar">
      <section class="avatar-section">
        <div hc-candidate-avatar model="candidate"></div>
        <div hc-candidate-avatar-edit model="candidate"></div>
      </section>

      <section class="salary-section">
        <div hc-candidate-salary model="candidate"></div>
        <div hc-candidate-salary-edit model="candidate"></div>
      </section>

      <section class="contact-section">
        <div hc-candidate-contact model="candidate"></div>
        <div hc-candidate-contact-edit model="candidate"></div>
      </section>

      <section class="birthdate-section">
        <div hc-candidate-birthdate model="candidate"></div>
        <div hc-candidate-birthdate-edit model="candidate"></div>
      </section>

      <!-- TODO: Check when offer flow is fixed
      <section class="offers-section">
        <div hc-candidate-offers model="candidate"></div>
      </section>
      -->

      <section class="availability-section">
        <div hc-candidate-availability model="candidate"></div>
        <div hc-candidate-availability-edit model="candidate"></div>
      </section>

      <section class="languages-section">
        <div hc-candidate-languages model="candidate"></div>
        <div hc-candidate-languages-edit model="candidate"></div>
      </section>
    </div>

    <div class="col-sm-9">
      <div class="row header">
        <div class="col-sm-8">
          <section class="name-section">
            <div hc-candidate-name model="candidate"></div>
            <div hc-candidate-name-edit model="candidate"></div>
          </section>

          <section class="target-section">
            <div hc-candidate-target model="candidate"></div>
            <div hc-candidate-target-edit model="candidate"></div>
          </section>

          <section class="summary-section">
            <div hc-candidate-summary model="candidate"></div>
            <div hc-candidate-summary-edit model="candidate"></div>
          </section>

          <section class="cv-section">
            <div hc-candidate-cv model="candidate"></div>
            <div hc-candidate-cv-edit model="candidate"></div>
          </section>
        </div>

        <div class="col-sm-4">
          <section class="status-section">
            <span><translate>Status</translate>: </span>
            <hc-candidate-status candidate="candidate" offers="allOffers"></hc-candidate-status>
          </section>

          <section class="privacy-section">
            <div hc-candidate-privacy model="candidate"></div>
            <div hc-candidate-privacy-edit model="candidate"></div>
          </section>
        </div>
      </div>

      <section class="row skills-section">
        <div class="col-sm-12">
          <div hc-candidate-skills model="candidate"></div>
          <div hc-candidate-skills-edit model="candidate"></div>
        </div>
      </section>

      <section class="row experience-section">
        <div class="col-sm-12">
          <div hc-candidate-experience model="candidate"></div>
          <div hc-candidate-experience-edit model="candidate"></div>
        </div>
      </section>

      <section class="row education-section">
        <div class="col-sm-12">
          <div hc-candidate-education model="candidate"></div>
          <div hc-candidate-education-edit model="candidate"></div>
        </div>
      </section>
    </div>



    <!-- END NEW SECTION -->


  <div class="col-sm-9">

    <div class="row bg-white">
      <div class="job-bar">
        <div class="job-bar-item" ng-repeat="entry in timeline"
             style="width: {{ entry.percent }}%"
             title="{{ entry.role }} - {{ entry.duration | yearMonth:false:lang }}">
          <div class="job-bar-item_up" ng-class="{
                      'bg-gray-light': $even,
                      'bg-blue-light': $odd,
                    }">{{ entry.duration | yearMonth:entry.percent:lang }}</div>
          <div class="job-bar-item_down">{{ entry.percent > 5 && entry.role || '' }}</div>
        </div>
      </div>
    </div>

    <div class="row bg-white mrg-btm">
      <div class="col-sm-12">
        <h2 class="big-title accordion-main-title">
          <translate>WORK EXPERIENCE</translate>
          <span class="accordion-title-extra">{{ totalWorkExperience | toMonthsYears:lang }}</span>
          <button class="add-btn" ng-show="isEditing && !formOpen" ng-click="experience.add()">
            <i class="fa fa-plus"></i> <translate>ADD</translate>
          </button>
        </h2>
        <div class="accordion-wrap">
          <!-- Add panel -->
          <div class="add-panel" ng-show="experience.editing === -2">
            <button class="add-panel-close" ng-click="experience.close()"><i class="fa fa-close"></i></button>
            <hc-experience-form
              hc-container="experience"
              name="form"
              hc-required="model.length === 0 || !experience.form.isPristine()"
              hc-disabled="loading"
              on-submit="experience.save($model, $form, model.length)">

              <div class="row">
                <div class="buttons-wrap">
                  <button type="submit" class="fl-rg bg-green btn-small mrg-lft-small" translate>save</button>
                  <button type="button" class="fl-rg bg-gray-lighter2 btn-small" ng-click="experience.close()" translate>cancel</button>
                </div>
              </div>
            </hc-experience-form>
          </div>
          <!--End  Add panel -->
          <div ng-repeat="entry in experience.data">
            <!-- EDIT panel -->
            <div class="add-panel edit-panel" ng-if="experience.editing === $index">
              <button class="add-panel-close" ng-click="experience.close()"><i class="fa fa-close"></i></button>
              <hc-experience-form
                ng-model="entry"
                hc-required="true"
                hc-disabled="loading"
                on-submit="experience.save($model, $form, $index)">
                <div class="row">
                  <div class="buttons-wrap">
                    <button type="submit" class="fl-rg bg-green btn-small mrg-lft-small" translate>save</button>
                    <button type="button" class="fl-rg bg-gray-lighter2 btn-small" ng-click="experience.close()" translate>cancel</button>
                  </div>
                </div>
              </hc-experience-form>
            </div>
            <!--End  EDIT panel -->
            <hc-accordion hc-hide-control="!entry.summary && !entry.skills.length" ng-hide="experience.editing === $index">
              <h3 class="accordion-subtitle">
                {{ entry.role }}
                <button type="button"
                        class="btn-edit-sub no-fl"
                        ng-show="isEditing"
                        ng-disabled="loading || formOpen"
                        ng-click="experience.edit(entry, $index)">
                  <i class="fa fa-pencil"></i>
                </button>
              </h3>
              <h4 class="accordion-subtitle2">{{ entry.company }}</h4>
              <span class="accordion-date">
                {{ entry.start | showMonthYear }} –
                <span ng-show="entry.end">{{ entry.end | showMonthYear }}</span>
                <span ng-hide="entry.end" translate>today</span>
                ({{ entry | momentDiff | toMonthsYears }})
              </span>
              <div class="accordion-text">{{ entry.summary }}</div>
              <div class="accordion-text" ng-show="entry.skills.length">
                <strong><translate>Technologies/Skills</translate>:</strong>
                {{ entry.skills.join(', ') }}
              </div>
            </hc-accordion>
          </div>
        </div>
      </div>
    </div>

    <div class="row bg-white">
      <div class="col-sm-12">
        <h2 class="big-title accordion-main-title">
          <translate>EDUCATION</translate>
          <span class="accordion-title-extra">{{ highestDegree }}</span>
          <button class="add-btn" ng-show="isEditing && !formOpen" ng-click="education.add()">
            <i class="fa fa-plus"></i> <translate>ADD</translate>
          </button>
        </h2>
        <div class="accordion-wrap">
          <!-- Add panel -->
          <div class="add-panel" ng-show="education.editing === -2">
            <button class="add-panel-close" ng-click="education.close()"><i class="fa fa-close"></i></button>
            <hc-education-form
              hc-container="education"
              name="form"
              hc-required="model.length === 0 || !education.form.isPristine()"
              hc-disabled="loading"
              on-submit="education.save($model, $form, model.length)">
              <div class="row">
                <div class="buttons-wrap">
                  <button type="submit" class="fl-rg bg-green btn-small mrg-lft-small" translate>save</button>
                  <button type="button" class="fl-rg bg-gray-lighter2 btn-small" ng-click="education.close()" translate>cancel</button>
                </div>
              </div>
            </hc-education-form>
          </div>
          <!--End  Add panel -->
          <div ng-repeat="entry in education.data">
            <!-- EDIT panel -->
            <div class="add-panel edit-panel" ng-if="education.editing === $index">
              <button class="add-panel-close" ng-click="education.close()"><i class="fa fa-close"></i></button>
              <hc-education-form
                ng-model="entry"
                hc-required="true"
                hc-disabled="loading"
                on-submit="education.save($model, $form, $index)">

                <div class="row">
                  <div class="buttons-wrap">
                    <button type="submit" class="fl-rg bg-green btn-small mrg-lft-small" translate>save</button>
                    <button type="button" class="fl-rg bg-gray-lighter2 btn-small" ng-click="education.close()" translate>cancel</button>
                  </div>
                </div>
              </hc-education-form>
            </div>
            <!--End  EDIT panel -->

            <div class="accordion-container">
              <h3 class="accordion-subtitle">
                {{ entry.degree }}
                <span class="accordion-subtitle-extra">{{ entry.course }}</span>
                <button type="button"
                        class="btn-edit-sub no-fl"
                        ng-show="isEditing"
                        ng-disabled="loading || formOpen"
                        ng-click="education.edit(entry, $index)">
                  <i class="fa fa-pencil"></i>
                </button>
              </h3>
              <h4 class="accordion-subtitle2">{{ entry.institution }}</h4>
              <span class="accordion-date">
                {{ entry.start}} –
                <span ng-show="entry.end">{{ entry.end }}</span>
                <span ng-hide="entry.end" translate>today</span>
                ({{ entry | momentDiff | toMonthsYears }})
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
</div>
