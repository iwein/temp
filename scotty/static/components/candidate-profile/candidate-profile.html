<div class="component-candidate-profile row" ng-show="ready">
  <div class="col-sm-6 col-sm-offset-3">

    <div class="page-header">
      <h1>
        <img class="avatar" ng-src="{{ user.picture_url }}">
        <small>{{ user.first_name }} {{ user.last_name }}</small>
      </h1>
      <button class="btn btn-primary"
        ng-show="!isEditing"
        ng-click="profile.edit()">
        Edit
      </button>
      <button class="btn btn-primary"
        ng-show="isEditing"
        ng-click="profile.stopEdit()">
        Finish
      </button>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Personal data</h3>
      </div>
      <div class="panel-body">
        <dl class="dl-horizontal">
          <dt>email</dt>
          <dd>{{ user.email }}</dd>
          <dt>Availabilty</dt>
          <dd>{{ user.available_date || (user.available_months + ' months') }}</dd>
          <dt ng-if="user.contact_skype">Skype</dt>
          <dd ng-if="user.contact_skype">{{ user.contact_skype }}</dd>
          <dt ng-if="user.stackoverflow_url">Stackoverflow</dt>
          <dd ng-if="user.stackoverflow_url">
            <a ng-href="{{ user.stackoverflow_url }}">{{ user.stackoverflow_url }}</a>
          </dd>
          <dt ng-if="user.github_url">Github</dt>
          <dd ng-if="user.github_url">
            <a ng-href="{{ user.github_url }}">{{ user.github_url }}</a>
          </dd>
          <dt>Address</dt>
          <dd>
            <address>
              {{ user.contact_line1 }}<br>
              {{ user.contact_line2 }}<br ng-if="user.contact_line2">
              {{ user.contact_line3 }}<br ng-if="user.contact_line3">
              {{ user.contact_city }},
              {{ user.contact_country_iso }}
              {{ user.contact_zipcode }}
            </address>
          </dd>
        </dl>
      </div>
    </div>

    <hc-skills-form
      ng-show="isEditing && skillsForm.editing"
      hc-scope="skillsForm"
      name="form"
      hc-disabled="loading"
      on-submit="skillsForm.save()">

      <button type="button"
        class="btn btn-primary"
        ng-click="skillsForm.cancel()"
        ng-disabled="loading">
        Cancel
      </button>
      <button type="submit"
        class="btn btn-primary"
        ng-disabled="loading">
        Save
      </button>
    </hc-skills-form>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          Skills
          <button type="submit"
            class="btn btn-default pull-right"
            ng-show="isEditing"
            ng-disabled="loading"
            ng-click="skillsForm.edit(skills)">
            Edit
          </button>
          <div class="clearfix"></div>
        </h3>
      </div>
      <ul class="list-group">
        <li class="list-group-item" ng-repeat="entry in skills">
          <span class="value">
            {{ entry.skill }}
            <span ng-if="entry.level">({{ entry.level }})</span>
          </span>
        </li>
      </ul>
    </div>

    <hc-languages-form
      ng-show="isEditing && languagesForm.editing"
      hc-scope="languagesForm"
      name="form"
      hc-disabled="loading"
      on-submit="languagesForm.save()">

      <button type="button"
        class="btn btn-primary"
        ng-click="languagesForm.cancel()"
        ng-disabled="loading">
        Cancel
      </button>
      <button type="submit"
        class="btn btn-primary"
        ng-disabled="loading">
        Save
      </button>
    </hc-languages-form>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          Languages
          <button type="submit"
            class="btn btn-default pull-right"
            ng-show="isEditing"
            ng-disabled="loading"
            ng-click="languagesForm.edit(languages)">
            Edit
          </button>
          <div class="clearfix"></div>
        </h3>
      </div>
      <ul class="list-group">
        <li class="list-group-item" ng-repeat="entry in languages">
          <span class="value">{{ entry.language }} ({{ entry.proficiency }})</span>
        </li>
      </ul>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          Preferred locations
        </h3>
      </div>
      <ul class="list-group" ng-repeat="(country_iso, cities) in cities">
        <li class="list-group-item" ng-repeat="city in cities">
          <span class="value">{{ city }}, {{ country_iso }}</span>
        </li>
      </ul>
    </div>

    <div ng-if="ready">
      <hc-target-position-form
        ng-show="isEditing && targetPosition.editing"
        hc-scope="targetPosition"
        name="form"
        on-submit="targetPosition.save()">
        <button type="button"
          class="btn btn-primary"
          ng-click="targetPosition.cancel()"
          ng-disabled="loading">
          Cancel
        </button>
        <button type="submit"
          class="btn btn-primary"
          ng-disabled="loading">
          Save
        </button>
      </hc-target-position-form>

      <hc-target-positions
        hc-scope="targetPosition"
        name="list"
        hc-title="Target positions"
        hc-source="session.user.getTargetPositions()"
        hc-editable="isEditing && !experience.editing"
        hc-source-remove="session.user.deleteTargetPosition($entry)"
        on-edit="targetPosition.edit($entry)"
        hc-show-empty="true">
      </hc-target-positions>

      <!-- EXPERIENCE -->

      <hc-experience-form
        ng-show="isEditing && experience.editing"
        hc-scope="experience"
        name="form"
        on-submit="experience.save()">

        <button type="button"
          class="btn btn-primary"
          ng-click="experience.cancel()"
          ng-disabled="loading">
          Cancel
        </button>
        <button type="submit"
          class="btn btn-primary"
          ng-disabled="loading">
          Save
        </button>
      </hc-experience-form>

      <hc-experience
        hc-scope="experience"
        name="list"
        hc-title="Experience"
        hc-source="session.user.getExperience()"
        hc-editable="isEditing && !experience.editing"
        hc-source-remove="session.user.deleteExperience($entry)"
        on-edit="experience.edit($entry)"
        hc-show-empty="true">

        <button type="submit"
          class="btn btn-default pull-right"
          ng-show="isEditing"
          ng-disabled="loading"
          ng-click="experience.add()">
          Add
        </button>
      </hc-experience>

      <!-- END EXPERIENCE -->

      <!-- EDUCATION -->

      <hc-education-form
        ng-show="isEditing && education.editing"
        hc-scope="education"
        name="form"
        on-submit="education.save()">

        <button type="button"
          class="btn btn-primary"
          ng-click="education.cancel()"
          ng-disabled="loading">
          Cancel
        </button>
        <button type="submit"
          class="btn btn-primary"
          ng-disabled="loading">
          Save
        </button>
      </hc-education-form>

      <hc-education
        hc-scope="education"
        name="list"
        hc-title="Education"
        hc-source="session.user.getEducation()"
        hc-source-remove="session.user.deleteEducation($entry)"
        on-edit="education.edit($entry)"
        hc-editable="isEditing && !education.editing"
        hc-show-empty="true">

        <button type="submit"
          class="btn btn-default pull-right"
          ng-show="isEditing"
          ng-disabled="loading"
          ng-click="education.add()">
          Add
        </button>
      </hc-education>

      <!-- END EDUCATION -->
    </div>
  </div>
</div>
